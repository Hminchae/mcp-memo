#설계 
### 요구사항 분석과 핵심 요소 식별
요구사항 속에는 만들어야할 데이터 세상의 모든 뼈대가 있다. 이 뼈대를 찾아내는 데 가장 효과적인 방법은 '명사' 와 '동사' 에 집중하는 것이다.
- 명사 : 우리가 `관리해야할 데이터의 대상`, 즉 엔티티 또는 그 엔티티가 가직는 속성이 될 확률이 높다
- 동사 : `데이터들 사이의 행위나 관계`, 즉 관계가 될 확률이 높다.

### 엔티티
엔티티는 우리가 데이터를 저장하고 관리해야할 대상을 의미한다. 조금 더 구체적으로는 '저장할 만한 가치가 있는 정보를 여러개 가지고 있으면서, 다른 것과 명확히 구분되는 유무형의 모든 것'을 말함

좋은 엔티티는 다음과 같은 특징을 가진다.

1. **업무 관련성**
	 엔티티는 반드시 해당 업무에 필요하고, 관리해야하는 정보여야 하며, 업무 프로세스에 의해 이용되어야 함
2. **식별이 가능해야 한다**
	 엔티테에 속하는 각각의 데이터(인스턴스)는 서로 명확하게 구분될 수 있어야 함, '회원' 시트에 회원명이 똑같은 '네이트'가 둘 있을 수 있고 이 둘을 구분하는 방법이 필요하다.  예를 들어 회원에게 고유한  번호나 아이디를 부여하는 것이다.
3. **두 개 이상의 정보를 가진다**
	 엔티티는 관리할 만한 가치가 있는 여러 정보, 즉 속성(Attribute)들을 가진다. 단 하나의 정보만 가지고 있다면, 이것은 엔티티가 아니라 다른 엔티티의 일부인 속성일 가능성이 높다.
4. **인스턴스의 집합이다**
	 엔티티는 개념적인 틀이고, 그 틀에 따라 만들어진 데이터 한 줄 한 줄을 인스턴스라고 부름. 엔티티는 영속적으로 존재하는 두 개 이상의 인스턴스로 구성된 집합 이여야 한다.

### 엔티티 분류
엔티티의 성격과 역할을 제대로 파악하고, 구분하는 과정이 `엔티티 분류`이다. 이 분류 과정을 통해 데이터의 본질을 꿰뚫어 보고, 앞으로 만들 데이터의 구조, 키(key)설계, 관계 설정, 그리고 성능 최적화 전략까지 설계의 큰 그림을 그릴 수 있다. 

개념적 모델링 단계에서 엔티티는 데이터의 성격, 역할, 그리고 다른 데이터와의 관계에 따라 여러 기준으로 분류할 수 있다. 이를통해 데이터 구조를 더 명확하게 이해하고 효율적인 데이터베이스를 설계할 수 있다. 엔티티를 분류하는 주요 기준은 존재 형태, 생성 시점 및 역할, 그리고 존재 종속성(독립성)이다.

#### 존재 형태에 따른 분류 : 유형, 개념, 사건 엔티티
엔티티를 식별하는 가장 직관적인 방법 중 하나는 엔티티가 나타내는 대상의 존재 형태를 기준으로 분류하는 것. 엔티티는 크게 `유형 엔티티`, `개념 엔티티`, `사건 엔티티`의 세가지로 분류할 수 있음

1. 유형 엔티티
   유형 엔티티는 물리적인 형태를 가지고 있어 눈으로 보거나 만질 수 있는 실체를 표현하는 엔티티임. 이것은 현실세계에 구체적으로 존재하는 객체들이므로, 데이터 모델링 과정에서 가장 먼저, 그리고 가장 쉽게 식별되는 경향이 있음
	   - 특징
		   - 물리적 형태가 존재
		   - 업무로부터 식별 용이
		   - 상대적으로 안정적이며 지속적으로 활용되는 정보를 담음
	   - 예시
		   - 사원, 학생, 고객, 교수(사람)
		   - 상품, 자재, 물품, 차량, 건물(사물)
		   - 강의실, 창고, 지점(장소)
2. 개념 엔티티
   개념 엔티티는 물리적인 형태는없지만 업무적으로 관리해야할 중요한 개념이나 아이디어를 표현하는 엔티티다. 이는 눈에 보이지 않기 때문에 유형 엔티티에 비해 식별하기가 다소 까다로울 수 있으며, 비즈니스 프로세스에 대한 깊이 있는 이해를 필요로 함
	   - 특징 :
		   - 물리적 형태가 없는 추상적인 개념
		   - 업무 규칙이나 제도, 분류 기준 등을 표현함
		   - 유형 엔티티와 마찬가지로 비교적 안정적인 정보를 관리함
	   - 예시 :
		   - 부서, 조직, 팀(조직 구조)
		   - 계좌, 보험 상품
		   - 과목, 학과
3. 사건 엔티티(이벤트 엔티티)
   사건 엔티티는 업무 프로세스가 진행됨에 따라 발생하는 특정 행위나 사건을 표현하는 엔티티임. 이는 특정 시점에 발생하며, 비즈니스 활동의 결과를 기록하는 역할을 함. 따라서 사건 엔티티는 시간이 지남에 따라 데이터가 지속적으로 누적되는 특징을 가지며, 각종 통계 및 분석 자료의 핵심 소스가 됨
	- 특징 : 
		- 업무 수행에 따라 발생하는 행위를 기록
		- 시간의 흐름에 따라 인스턴스가 계속해서 발생함
		- 발생량이 많고, 각종 통계 자료에 활용될 수 있음
	- 예시
		- 주문, 계약, 청구, 매출(판매 및 계약 관련 사건)
		- 결제, 입금, 출금, 미납(재무 관련 사건)
		- 수강 신청, 예약, 취소, 사고접수(서비스 관련 사건)

실무 관점에서 사건 엔티티는 시간이 지남에 따라 데이터가 폭발적으로 증가할 것을 예측할 수 있음. 데이터의 성격과 증가 추이를 미리 파악하면, `주문` 같은 테이블을 설계할 때부터 다음과 같은 전략을 세울 수 있음
- **인덱스 전략** : 데이터가 수백만 건이 되면, 특정 회원의 주문 목록을 찾거나(WHERE 회원id = ?) 특정 날짜의 주문을 조회하는 (WHERE 주문 일시 BETWEEN ? AND ?) SELECT 문은 인덱스 없이는 재앙적인 성능 저하를 일으킴. 따라서 회원 id 나 주문 일시 같은 조회 조건으로 자주 사용될 컬럼에 `인덱스`를 생성하는 것은 선택이 아닌 필수
- **데이터 파티셔닝 및 아카이빙** : 5년전, 10년 전 주문 데이터까지 하나의 거대한 테이블에 모두 담아두는 것은 매우 비효율적임. 파티셔닝은 주문 테이블을 주문일시 기준으로 물리적으로 분리하여 저장하는 기술임. 이렇게 하면 최근 한 달 주문 조회 와 같은 쿼리는 훨씬 작은 데이터 영역만 탐색하므로 속도가 비약적으로 향상됨. 아카이빙은 아예 사용 빈도가 극히 낮은 오래된 데이터를 별도의 백업 테이블이나 스토리지로 옮겨서, 현재 운영중인 테이블의 크기를 작고 빠르게 유지하는 전략임

#### 역할 및 발생 시점에 따른 분류 : 기본, 중심, 행위 엔티티
엔티티는 비즈니스 프로세스 내에서 수행하는 역할과 데이터가 생성되는 시점에 따라 계층적으로 분류할 수 있음. 이 분류법은 데이터의 발생 순서와 의존성을 명확히 하여 모델의 논리적 흐름을 체계화 함. 일반적으로 `기본 엔티티`,`중심 엔티티`, `행위 엔티티`로 구분함

1. 기본 엔티티
   기본 엔티티는 업무에 원래부터 존재하는 정보, 다른 엔티티에 의해 생성되지 않고 독립적으로 존재할 수 있는 핵심적인 엔티티. `키 엔티티` 라고도 불리며, 일반적으로 다른 엔티티의 부모 역할을 수행함. 기본 엔티티는 다른 엔티티로부터 `주 식별자`를 상속받지 않고 자신만의 고유한 `주 식별자`를 가진다는 특징
	 - 특징
		 - 독립적으로 생성이 가능
		 - 주로 다른 엔티티의 부모 역할을 함
		 - 자신만의 고유한 주식별자를 가짐
	 - 예시
		 - 회원, 상품, 사원, 부서, 고객 , 자제
2. 중심 엔티티
   중심엔티티는 기본 엔티티로부터 파생되어 생성되며, 해당 업무에서 중심적인 역할을 수행하는 엔티티, 이들은 독립적으로 존재하기보다는 기본 엔티티 간의 관계에서 발생하는 핵심적인 비즈니스 트랜잭션을 나타내는 경우가 많음. 따라서 데이터 발생량이 많고, 다른 엔티티와의 관계를 통해 수많은 `행위 엔티티와의 관계를 통해 수많은 행위 엔티티를 생성하는 허브 역할` 을 함
	- 특징 :
		- 기본 엔티티로부터 발생
		- 업무 프로세스의 중심적인 역할을 담당 
	- 예시 :
		- 주문, 계약, 청구, 매출
3. 행위 엔티티
   행위 엔티티는 두 개 이상의 부모엔티티(주로 기본 엔티티와 중심 엔티티)로부터 발생하며, 업무가 흘러가면서 생성되는 상세 정보를 기록하는 엔티티, 이들은 내용이 자주 변경되거나 데이터 양이 지속적으로 증가하는 특징을 가짐, 모델 내에서 데이터양이 가장 많은 엔티티가 되는 경우가 많음 
  - 특징 :
	  - 두 개 이상의 부모 엔티티로부터 발생
	  - 데이터 내용이 자주 변경되거나 데이터양의 빠르게 증가함
	  - 상세 설계 단계에서 도출되는 경우가 많음
  - 예시
	  - 주문 이력, 신청변경이력, 결제 내역, 로그, 주문 항목

이런 분류는 왜 하는건데?
1. 모델의 이해도와 커뮤니케이션 비용 감소 : 회원은 기본 엔티티, 주문은 중심 엔티티, 주문 상품은 행위 엔티티 라고 정의하면, 데이터의 위계와 흐름을 동일한 관점에서 이해 가능. 
2. 체계적인 개발 순서와 일정 관리 : 엔티티 분류는 그대로 개발의 우선순위가 됨. 독립적으로 존재하는 기본 엔티티부터 개발 하여야 함, 그 다음 이들을 기반으로 동작하는 중심 엔티티 기능을, 마지막으로는 상세 내역인 행위 엔티티(주문 이력, 결제 내역) 기능을 구현하는 것이 자연스러운 순서
3. 성능과 데이터 관리 전략 수립의 기준 : 
	- 엔티티의 특성은 곧 데이터의 특성
	- 기본 엔티티(회원, 상품) : 데이터 변경이 잦지 않고, 주로 조회(READ) 작업이 많다. 따라서 조회 성능에 최적화된 인덱싱 전략이 중요함
	- 중심 엔티티 (주문) : 조회의 중심축이자 트랜잭션의 핵심, 데이터는 꾸준히 증가하며, 조회(SELECT)뿐만 아니라 주문 상태 변경(UPDATE) 도 빈번하게 일어남. 따라서 다양한 검색 조건에 대한 인덱스 전략이 매우 중요함
		- 예를 들어 주문 테이블은 사용자가 '내 주문 목록'을 볼 때, 관리자가 '오늘의 주문'을 확인할 때(주문 일시 기준),  '배송 준비 중'인 주문을 찾을 때 등 여러 방식으로 조회됨
		- 따라서 회원 id, 주문 일시, 주문 상태 같은 컬럼에는 각각의 쓰임새에 맞는 인덱스를 생성하는 것이 성능 유지의 관건임
	- 행위 엔티티 : 하나의 주문을 할 때, 결제 방식을 신용카드, 포인트, 쿠폰 3가지를 사용해서 결제했다고 가정하면, 주문은 하나의 행이 만들어지지만, 결제 내역(행위 엔티티)는 3개의 행이 만들어짐. 따라서 데이터가 폭발적으로 증가 하며, 가장 많은 공간을 차지하게 될 테이블임. 따라서 설계 초기부터 `데이터 파티셔닝`, `주기적인 아카이빙 전략`을 꼭 고민해야함

#### 강한 엔티티와 약한 엔티티
1. 강한 엔티티 : 강한 엔티티는 다른 어떤 엔티티의 존재 여부와 관계없이 독립적으로 존재할 수 있는 엔티티. 자신의 존재를 위해 다른 엔티티에 의존하지 않음. 강항 엔티티는 자신을 유일하게 식별할 수 있는 고유한 속성 또는 속성들의 집합, 즉 PK 를 가지고 있다.
	- 특징 :
		- 독립적인 존재가 가능함 
		- 자신만의 고유한 주식별자를 가짐
		- 다른 엔티티의 존재에 의존 x
	- 예시
		- 사원, 고객, 상품, 부서 등과 같이 독립적으로 관리될 수 있는 대부분의 엔티티
2. 약한 엔티티 : 다른 엔티티가 존재하지 않으면 독립적으로 존재할 수 없는 종속적 엔티티
	- 특징 : 약한 엔티티는 소유 엔티티가 있어야만 자신의 존재가 의미를 가짐
	- 식별자 구성 : 전통적인 방식에서 약한 엔티티는 자신을 식별하기 위해 소유 엔티티의 주식별자를 빌려와 자신의 속성(부분키)과 결합하여 주식별자로 삼음
		- 예를들어 부모의 기본키를 가져와 자식의 속성과 합쳐 복합 기본키를 만든다.
부모 엔티티 정보가 없는 자식 데이터, 즉 고아 데이터가 생기면 데이터베이스의 정합성(Integrity)이 깨지고, 인사 관리 시스템 전체가 신뢰를 잃게 됨

#### 구조적 관계 표현을 위한 특수 엔티티
엔티티 간의 관계가 단순한 연관성을 넘어, 그 자체가 하나의 독립된 의미를 갖는 개념일 때가 있음. 이러한 사건이나 분류와 같은 복잡한 관계를 효과적으로 모델에 반영하기 위해 사용하는 것이 바로 연관 엔티티와 슈퍼타입/서브타입 구조임
1. 연관 엔티티 : 연관 엔티티는 두 개 이상의 엔티티 간의 발생하는 특정 사건, 행위, 계약 등을 표현하기 위해 도출되는 엔티티, 즉 관계 자체가 중요한 속성을 가져 하나의 독립된 실체로 다뤄져야 할 때 사용됨
	- 개념적 본질 : 연관 엔티티의 가장 중요한 존재 이유는 '관계에 종속되는 속성을 저장' 하기 위함이다. 예를 들어 학생과 과목의 관계에서는 성적이나 수강신청일 같은 데이터가 발생함. 이 데이터는 '학생'의 것도 '과목'의 것도 아닌 '수강' 이라는 행위 자체에 속함. 이 수강을 표현하는 것이 연관 엔티티임
	- 구조적 의미 : 연관 엔티티는 두 개 이상의 다른 엔티티 간에 존재하는 다대다 관계를 해소함. 관계형 DB 는 다대다 관계를 직접 구현할 수 없기 때문에 중간 엔티티를 통해 하나의 다대다 관계를 일대 다 관계로 변환한다.
2. 슈퍼타입/서브타입 엔티티 : 논리적으로 동일한 개념 그룹에 속하지만 일부 속성이나 관계에서 차이가 있는 엔티티들을 효과적으로 표현하기 위한 기법. 이는 IS-A 관계(예 : 관리자는 사원의 한 종류이다)를 모델링하며, 객체지향 프로그래밍의 개념과 매우 유사함
	- 슈퍼타입 : 그룹 내 모든 엔티티들이 공통적으로 가지는 속성과 관계를 정의하는 상위 엔티티
	- 서브타입 : 슈퍼타입으로부터 공통 속성을 상속받고, 자신만의  고유한 속성이나 관계를 추가로 가지는 하위 엔티티
	- 예시 : '사원'엔티티를 슈퍼타입으로, '정규직 사원'과 '계약직 사원'을 서브타입으로 모델링할 수 있음